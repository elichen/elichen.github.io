<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake AI - Reinforcement Learning</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.16.0/dist/tf.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Snake AI</h1>
        <p class="subtitle">Full-board PPO policy running in TensorFlow.js</p>

        <div class="canvas-wrapper">
            <canvas id="gameCanvas" width="600" height="600"></canvas>
        </div>

        <div class="stats">
            <div class="stat-item">
                <span class="stat-value" id="score">0</span>
                <span class="stat-label">Current Score</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="episode">1</span>
                <span class="stat-label">Episode</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="foodEaten">0</span>
                <span class="stat-label">Food Eaten</span>
            </div>
        </div>

        <p id="modelStatus"></p>

        <div class="description">
            <p>This agent was trained end-to-end on the full 20×20 board using PPO with a convolutional policy. Observations consist of four semantic channels (head, body, food, walls) stacked across the last four frames, giving the network consistent spatial awareness.</p>
        </div>

        <div class="metrics">
            <div class="metric-card">
                <div class="label">Training Steps</div>
                <div class="value">10M</div>
            </div>
            <div class="metric-card">
                <div class="label">Parallel Envs</div>
                <div class="value">8 CPU</div>
            </div>
            <div class="metric-card">
                <div class="label">Observation</div>
                <div class="value">16×20×20 + 24 stats</div>
            </div>
            <div class="metric-card">
                <div class="label">Model Size</div>
                <div class="value">~6 MB</div>
            </div>
        </div>

        <div class="technical-details">
            <h3>Architecture</h3>
            <ul>
                <li>Algorithm: PPO (55-step rollouts, batch 2048)</li>
                <li>Observation: 4-channel board tensor stacked over 4 frames + 24 scalar features</li>
                <li>Network: 3-layer CNN → MLP actor-critic head (shared features)</li>
                <li>Training: 8 parallel Snake environments on Apple CPU backend</li>
                <li>Weights exported via ONNX → TensorFlow.js</li>
            </ul>
        </div>

        <div class="description">
            <p>The model avoids the handcrafted features of the earlier demo and instead reasons directly over the full board. TensorFlow.js executes the exact PPO policy that was trained in PyTorch, so what you see here matches the offline training run.</p>
        </div>
    </div>

    <script src="snake.js"></script>
    <script src="tf-model-pretrained.js"></script>
    <script src="agent-pretrained.js"></script>
    <script src="script-pretrained.js"></script>
</body>
</html>
